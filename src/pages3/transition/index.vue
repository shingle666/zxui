<template>
  <view class="container">
    <zx-navbar title="ZxTransition è¿‡æ¸¡åŠ¨ç”»" />
    
    <scroll-view scroll-y class="scroll-view">
      <!-- åŸºç¡€åŠ¨ç”» -->
      <view class="section">
        <view class="section-title">åŸºç¡€åŠ¨ç”»æ•ˆæœ</view>
        
        <view class="demo-item">
          <view class="demo-title">æ·¡å…¥æ·¡å‡º (fade)</view>
          <view class="demo-content">
            <zx-transition :show="show.fade" mode-class="fade">
              <view class="demo-box fade-box">Fade Animation</view>
            </zx-transition>
          </view>
          <button @click="toggle('fade')" class="demo-btn">
            {{ show.fade ? 'éšè—' : 'æ˜¾ç¤º' }}
          </button>
        </view>
        
        <view class="demo-item">
          <view class="demo-title">ä»ä¸Šæ»‘å…¥ (slide-top)</view>
          <view class="demo-content">
            <zx-transition :show="show.slideTop" mode-class="slide-top">
              <view class="demo-box slide-box">Slide Top</view>
            </zx-transition>
          </view>
          <button @click="toggle('slideTop')" class="demo-btn">
            {{ show.slideTop ? 'éšè—' : 'æ˜¾ç¤º' }}
          </button>
        </view>
        
        <view class="demo-item">
          <view class="demo-title">ä»å³æ»‘å…¥ (slide-right)</view>
          <view class="demo-content">
            <zx-transition :show="show.slideRight" mode-class="slide-right">
              <view class="demo-box slide-box">Slide Right</view>
            </zx-transition>
          </view>
          <button @click="toggle('slideRight')" class="demo-btn">
            {{ show.slideRight ? 'éšè—' : 'æ˜¾ç¤º' }}
          </button>
        </view>
        
        <view class="demo-item">
          <view class="demo-title">ä»ä¸‹æ»‘å…¥ (slide-bottom)</view>
          <view class="demo-content">
            <zx-transition :show="show.slideBottom" mode-class="slide-bottom">
              <view class="demo-box slide-box">Slide Bottom</view>
            </zx-transition>
          </view>
          <button @click="toggle('slideBottom')" class="demo-btn">
            {{ show.slideBottom ? 'éšè—' : 'æ˜¾ç¤º' }}
          </button>
        </view>
        
        <view class="demo-item">
          <view class="demo-title">ä»å·¦æ»‘å…¥ (slide-left)</view>
          <view class="demo-content">
            <zx-transition :show="show.slideLeft" mode-class="slide-left">
              <view class="demo-box slide-box">Slide Left</view>
            </zx-transition>
          </view>
          <button @click="toggle('slideLeft')" class="demo-btn">
            {{ show.slideLeft ? 'éšè—' : 'æ˜¾ç¤º' }}
          </button>
        </view>
        
        <view class="demo-item">
          <view class="demo-title">ç¼©æ”¾è¿›å…¥ (zoom-in)</view>
          <view class="demo-content">
            <zx-transition :show="show.zoomIn" mode-class="zoom-in">
              <view class="demo-box zoom-box">Zoom In</view>
            </zx-transition>
          </view>
          <button @click="toggle('zoomIn')" class="demo-btn">
            {{ show.zoomIn ? 'éšè—' : 'æ˜¾ç¤º' }}
          </button>
        </view>
        
        <view class="demo-item">
          <view class="demo-title">ç¼©æ”¾é€€å‡º (zoom-out)</view>
          <view class="demo-content">
            <zx-transition :show="show.zoomOut" mode-class="zoom-out">
              <view class="demo-box zoom-box">Zoom Out</view>
            </zx-transition>
          </view>
          <button @click="toggle('zoomOut')" class="demo-btn">
            {{ show.zoomOut ? 'éšè—' : 'æ˜¾ç¤º' }}
          </button>
        </view>
      </view>
      
      <!-- ç»„åˆåŠ¨ç”» -->
      <view class="section">
        <view class="section-title">ç»„åˆåŠ¨ç”»æ•ˆæœ</view>
        
        <view class="demo-item">
          <view class="demo-title">æ·¡å…¥ + æ»‘åŠ¨</view>
          <view class="demo-content">
            <zx-transition :show="show.combo1" :mode-class="['fade', 'slide-top']">
              <view class="demo-box combo-box">Fade + Slide</view>
            </zx-transition>
          </view>
          <button @click="toggle('combo1')" class="demo-btn">
            {{ show.combo1 ? 'éšè—' : 'æ˜¾ç¤º' }}
          </button>
        </view>
        
        <view class="demo-item">
          <view class="demo-title">ç¼©æ”¾ + æ»‘åŠ¨</view>
          <view class="demo-content">
            <zx-transition :show="show.combo2" :mode-class="['zoom-in', 'slide-bottom']">
              <view class="demo-box combo-box">Zoom + Slide</view>
            </zx-transition>
          </view>
          <button @click="toggle('combo2')" class="demo-btn">
            {{ show.combo2 ? 'éšè—' : 'æ˜¾ç¤º' }}
          </button>
        </view>
      </view>
      
      <!-- è‡ªå®šä¹‰åŠ¨ç”» -->
      <view class="section">
        <view class="section-title">è‡ªå®šä¹‰åŠ¨ç”»</view>
        
        <view class="demo-item">
          <view class="demo-title">è‡ªå®šä¹‰åŠ¨ç”»æ—¶é•¿</view>
          <view class="demo-content">
            <zx-transition :show="show.custom1" mode-class="fade" :duration="1000">
              <view class="demo-box custom-box">æ…¢é€ŸåŠ¨ç”» (1s)</view>
            </zx-transition>
          </view>
          <button @click="toggle('custom1')" class="demo-btn">
            {{ show.custom1 ? 'éšè—' : 'æ˜¾ç¤º' }}
          </button>
        </view>
        
        <view class="demo-item">
          <view class="demo-title">è‡ªå®šä¹‰æ ·å¼</view>
          <view class="demo-content">
            <zx-transition 
              :show="show.custom2" 
              mode-class="zoom-in"
              :styles="{ backgroundColor: '#ff6b6b', borderRadius: '20px' }"
            >
              <view class="demo-box custom-box">è‡ªå®šä¹‰æ ·å¼</view>
            </zx-transition>
          </view>
          <button @click="toggle('custom2')" class="demo-btn">
            {{ show.custom2 ? 'éšè—' : 'æ˜¾ç¤º' }}
          </button>
        </view>
        
        <view class="demo-item">
          <view class="demo-title">æ‰‹åŠ¨æ§åˆ¶åŠ¨ç”»</view>
          <view class="demo-content">
            <zx-transition ref="manualTransition" :show="false">
              <view class="demo-box manual-box">æ‰‹åŠ¨åŠ¨ç”»</view>
            </zx-transition>
          </view>
          <view class="btn-group">
            <button @click="runManualAnimation" class="demo-btn small">
              æ‰§è¡ŒåŠ¨ç”»
            </button>
            <button @click="runComplexAnimation" class="demo-btn small">
              å¤æ‚åŠ¨ç”»
            </button>
          </view>
        </view>
      </view>
      
      <!-- å®é™…åº”ç”¨åœºæ™¯ -->
      <view class="section">
        <view class="section-title">å®é™…åº”ç”¨åœºæ™¯</view>
        
        <view class="demo-item">
          <view class="demo-title">æ¨¡æ€å¼¹çª—</view>
          <view class="demo-content">
            <button @click="showModal = true" class="demo-btn">
              æ‰“å¼€å¼¹çª—
            </button>
            
            <!-- å¼¹çª—é®ç½© -->
            <zx-transition :show="showModal" mode-class="fade">
              <view class="modal-overlay" @click="showModal = false">
                <!-- å¼¹çª—å†…å®¹ -->
                <zx-transition :show="showModal" mode-class="zoom-in">
                  <view class="modal-content" @click.stop>
                    <view class="modal-title">æç¤º</view>
                    <view class="modal-text">è¿™æ˜¯ä¸€ä¸ªå¸¦åŠ¨ç”»çš„å¼¹çª—</view>
                    <view class="modal-actions">
                      <button @click="showModal = false" class="modal-btn">
                        ç¡®å®š
                      </button>
                    </view>
                  </view>
                </zx-transition>
              </view>
            </zx-transition>
          </view>
        </view>
        
        <view class="demo-item">
          <view class="demo-title">åˆ—è¡¨åŠ¨ç”»</view>
          <view class="demo-content">
            <button @click="toggleList" class="demo-btn">
              {{ showList ? 'éšè—åˆ—è¡¨' : 'æ˜¾ç¤ºåˆ—è¡¨' }}
            </button>
            
            <view class="list-container">
              <zx-transition 
                v-for="(item, index) in listItems" 
                :key="item.id"
                :show="item.visible" 
                mode-class="slide-left"
                :duration="200 + index * 100"
              >
                <view class="list-item">
                  <view class="list-avatar">{{ item.avatar }}</view>
                  <view class="list-content">
                    <view class="list-title">{{ item.title }}</view>
                    <view class="list-desc">{{ item.desc }}</view>
                  </view>
                </view>
              </zx-transition>
            </view>
          </view>
        </view>
        
        <view class="demo-item">
          <view class="demo-title">æ¶ˆæ¯æç¤º</view>
          <view class="demo-content">
            <button @click="showToast" class="demo-btn">
              æ˜¾ç¤ºæ¶ˆæ¯
            </button>
            
            <zx-transition :show="toastVisible" mode-class="slide-top">
              <view class="toast">
                <text class="toast-text">æ“ä½œæˆåŠŸï¼</text>
              </view>
            </zx-transition>
          </view>
        </view>
      </view>
      
      <!-- æ‰¹é‡æ§åˆ¶ -->
      <view class="section">
        <view class="section-title">æ‰¹é‡æ§åˆ¶</view>
        
        <view class="demo-item">
          <view class="demo-content">
            <view class="btn-group">
              <button @click="showAll" class="demo-btn">
                æ˜¾ç¤ºæ‰€æœ‰
              </button>
              <button @click="hideAll" class="demo-btn">
                éšè—æ‰€æœ‰
              </button>
              <button @click="toggleAll" class="demo-btn">
                åˆ‡æ¢æ‰€æœ‰
              </button>
            </view>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>
</template>

<script setup>
import { ref, reactive, onMounted } from 'vue'

// å“åº”å¼æ•°æ®
const show = reactive({
  fade: false,
  slideTop: false,
  slideRight: false,
  slideBottom: false,
  slideLeft: false,
  zoomIn: false,
  zoomOut: false,
  combo1: false,
  combo2: false,
  custom1: false,
  custom2: false
})

const showModal = ref(false)
const showList = ref(false)
const toastVisible = ref(false)
const manualTransition = ref(null)

const listItems = reactive([
  { id: 1, avatar: 'ğŸ‘¤', title: 'ç”¨æˆ·1', desc: 'è¿™æ˜¯ç”¨æˆ·1çš„æè¿°ä¿¡æ¯', visible: false },
  { id: 2, avatar: 'ğŸ‘¥', title: 'ç”¨æˆ·2', desc: 'è¿™æ˜¯ç”¨æˆ·2çš„æè¿°ä¿¡æ¯', visible: false },
  { id: 3, avatar: 'ğŸ‘¨', title: 'ç”¨æˆ·3', desc: 'è¿™æ˜¯ç”¨æˆ·3çš„æè¿°ä¿¡æ¯', visible: false },
  { id: 4, avatar: 'ğŸ‘©', title: 'ç”¨æˆ·4', desc: 'è¿™æ˜¯ç”¨æˆ·4çš„æè¿°ä¿¡æ¯', visible: false }
])

// æ–¹æ³•å®šä¹‰
const toggle = (key) => {
  show[key] = !show[key]
}

const showAll = () => {
  Object.keys(show).forEach(key => {
    show[key] = true
  })
}

const hideAll = () => {
  Object.keys(show).forEach(key => {
    show[key] = false
  })
}

const toggleAll = () => {
  Object.keys(show).forEach(key => {
    show[key] = !show[key]
  })
}

const toggleList = () => {
  showList.value = !showList.value
  listItems.forEach((item, index) => {
    setTimeout(() => {
      item.visible = showList.value
    }, index * 100)
  })
}

const showToast = () => {
  toastVisible.value = true
  setTimeout(() => {
    toastVisible.value = false
  }, 2000)
}

const runManualAnimation = () => {
  if (!manualTransition.value) return
  
  manualTransition.value.init({
    duration: 300,
    timingFunction: 'ease-in-out'
  })
  
  manualTransition.value
    .step({
      translateX: [100],
      opacity: [0.5]
    })
    .step({
      translateX: [0],
      opacity: [1]
    })
    .run(() => {
      console.log('æ‰‹åŠ¨åŠ¨ç”»æ‰§è¡Œå®Œæˆ')
    })
}

const runComplexAnimation = () => {
  if (!manualTransition.value) return
  
  manualTransition.value.init({
    duration: 200,
    timingFunction: 'ease'
  })
  
  manualTransition.value
    .step({
      scale: [1.2],
      rotate: [90]
    })
    .step({
      scale: [0.8],
      rotate: [180]
    })
    .step({
      scale: [1],
      rotate: [360],
      translateY: [-20]
    })
    .step({
      translateY: [0]
    })
    .run(() => {
      console.log('å¤æ‚åŠ¨ç”»æ‰§è¡Œå®Œæˆ')
    })
}
</script>

<style scoped>
.container {
  height: 100vh;
  background-color: #f5f5f5;
}

.scroll-view {
  height: calc(100vh - 44px);
  padding: 20rpx;
}

.section {
  margin-bottom: 40rpx;
}

.section-title {
  font-size: 32rpx;
  font-weight: bold;
  color: #333;
  margin-bottom: 20rpx;
  padding: 0 20rpx;
}

.demo-item {
  background: white;
  border-radius: 16rpx;
  padding: 30rpx;
  margin-bottom: 20rpx;
  box-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.1);
}

.demo-title {
  font-size: 28rpx;
  font-weight: 500;
  color: #666;
  margin-bottom: 20rpx;
}

.demo-content {
  min-height: 120rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 20rpx;
  position: relative;
}

.demo-box {
  padding: 20rpx 40rpx;
  border-radius: 12rpx;
  color: white;
  font-size: 24rpx;
  text-align: center;
  min-width: 200rpx;
}

.fade-box {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.slide-box {
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
}

.zoom-box {
  background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
}

.combo-box {
  background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
}

.custom-box {
  background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
}

.manual-box {
  background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
  color: #333;
}

.demo-btn {
  background: #007aff;
  color: white;
  border: none;
  border-radius: 8rpx;
  padding: 16rpx 32rpx;
  font-size: 24rpx;
  margin: 0 10rpx;
}

.demo-btn.small {
  padding: 12rpx 24rpx;
  font-size: 22rpx;
}

.btn-group {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 20rpx;
}

/* å¼¹çª—æ ·å¼ */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.modal-content {
  background: white;
  border-radius: 16rpx;
  padding: 40rpx;
  margin: 40rpx;
  max-width: 600rpx;
  width: 80%;
}

.modal-title {
  font-size: 32rpx;
  font-weight: bold;
  text-align: center;
  margin-bottom: 20rpx;
}

.modal-text {
  font-size: 28rpx;
  color: #666;
  text-align: center;
  margin-bottom: 40rpx;
}

.modal-actions {
  display: flex;
  justify-content: center;
}

.modal-btn {
  background: #007aff;
  color: white;
  border: none;
  border-radius: 8rpx;
  padding: 16rpx 40rpx;
  font-size: 24rpx;
}

/* åˆ—è¡¨æ ·å¼ */
.list-container {
  margin-top: 20rpx;
}

.list-item {
  display: flex;
  align-items: center;
  background: white;
  border-radius: 12rpx;
  padding: 20rpx;
  margin-bottom: 16rpx;
  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);
}

.list-avatar {
  width: 80rpx;
  height: 80rpx;
  border-radius: 50%;
  background: #f0f0f0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 32rpx;
  margin-right: 20rpx;
}

.list-content {
  flex: 1;
}

.list-title {
  font-size: 28rpx;
  font-weight: 500;
  color: #333;
  margin-bottom: 8rpx;
}

.list-desc {
  font-size: 24rpx;
  color: #999;
}

/* æ¶ˆæ¯æç¤ºæ ·å¼ */
.toast {
  position: fixed;
  top: 100rpx;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 20rpx 40rpx;
  border-radius: 8rpx;
  z-index: 1000;
}

.toast-text {
  font-size: 24rpx;
}
</style>