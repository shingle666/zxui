<template>
	<view class="demo-container">
		<view class="page-header">
			<text class="page-title">zx-tabs æ ‡ç­¾é¡µç»„ä»¶</text>
			<text class="page-desc">åŸºäº Element Plus Tabs ç»„ä»¶è®¾è®¡çš„ uni-app æ ‡ç­¾é¡µç»„ä»¶</text>
		</view>

		<view class="demo-section">
			<view class="demo-title">åŸºç¡€ç”¨æ³•</view>
			<view class="demo-desc">åŸºç¡€çš„ã€ç®€æ´çš„æ ‡ç­¾é¡µã€‚é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªæ ‡ç­¾é¡µã€‚</view>
			<zx-tabs v-model="activeTab1" @tab-click="handleTabClick">
				<zx-tab-pane label="ç”¨æˆ·ç®¡ç†" name="user">
					<view class="pane-content">
						<text class="content-title">ç”¨æˆ·ç®¡ç†</text>
						<text class="content-text">è¿™é‡Œæ˜¯ç”¨æˆ·ç®¡ç†çš„å†…å®¹ï¼ŒåŒ…å«ç”¨æˆ·åˆ—è¡¨ã€æƒé™è®¾ç½®ç­‰åŠŸèƒ½ã€‚</text>
					</view>
				</zx-tab-pane>
				<zx-tab-pane label="é…ç½®ç®¡ç†" name="config">
					<view class="pane-content">
						<text class="content-title">é…ç½®ç®¡ç†</text>
						<text class="content-text">è¿™é‡Œæ˜¯é…ç½®ç®¡ç†çš„å†…å®¹ï¼ŒåŒ…å«ç³»ç»Ÿé…ç½®ã€å‚æ•°è®¾ç½®ç­‰åŠŸèƒ½ã€‚</text>
					</view>
				</zx-tab-pane>
				<zx-tab-pane label="è§’è‰²ç®¡ç†" name="role">
					<view class="pane-content">
						<text class="content-title">è§’è‰²ç®¡ç†</text>
						<text class="content-text">è¿™é‡Œæ˜¯è§’è‰²ç®¡ç†çš„å†…å®¹ï¼ŒåŒ…å«è§’è‰²åˆ†é…ã€æƒé™ç®¡ç†ç­‰åŠŸèƒ½ã€‚</text>
					</view>
				</zx-tab-pane>
				<zx-tab-pane label="ä»»åŠ¡ç®¡ç†" name="task" disabled>
					<view class="pane-content">
						<text class="content-title">ä»»åŠ¡ç®¡ç†</text>
						<text class="content-text">æ­¤æ ‡ç­¾é¡µå·²ç¦ç”¨ï¼Œæ— æ³•é€‰ä¸­ã€‚</text>
					</view>
				</zx-tab-pane>
			</zx-tabs>
		</view>

		<view class="demo-section">
			<view class="demo-title">å¡ç‰‡é£æ ¼</view>
			<view class="demo-desc">è®¾ç½® type å±æ€§ä¸º card å°±å¯ä»¥ä½¿é€‰é¡¹å¡æ”¹å˜ä¸ºæ ‡ç­¾é£æ ¼ã€‚</view>
			<zx-tabs v-model="activeTab2" type="card" @tab-click="handleTabClick">
				<zx-tab-pane label="é¦–é¡µ" name="home">
					<view class="pane-content">
						<text class="content-title">é¦–é¡µå†…å®¹</text>
						<text class="content-text">æ¬¢è¿æ¥åˆ°é¦–é¡µï¼Œè¿™é‡Œå±•ç¤ºäº†ç³»ç»Ÿçš„æ¦‚è§ˆä¿¡æ¯ã€‚</text>
					</view>
				</zx-tab-pane>
				<zx-tab-pane label="äº§å“" name="product">
					<view class="pane-content">
						<text class="content-title">äº§å“åˆ—è¡¨</text>
						<text class="content-text">è¿™é‡Œå±•ç¤ºäº†æ‰€æœ‰çš„äº§å“ä¿¡æ¯å’Œç®¡ç†åŠŸèƒ½ã€‚</text>
					</view>
				</zx-tab-pane>
				<zx-tab-pane label="å…³äº" name="about">
					<view class="pane-content">
						<text class="content-title">å…³äºæˆ‘ä»¬</text>
						<text class="content-text">äº†è§£æ›´å¤šå…³äºæˆ‘ä»¬å…¬å¸å’Œäº§å“çš„ä¿¡æ¯ã€‚</text>
					</view>
				</zx-tab-pane>
			</zx-tabs>
		</view>

		<view class="demo-section">
			<view class="demo-title">è¾¹æ¡†å¡ç‰‡é£æ ¼</view>
			<view class="demo-desc">è®¾ç½® type å±æ€§ä¸º border-cardã€‚</view>
			<zx-tabs v-model="activeTab3" type="border-card">
				<zx-tab-pane label="è®¢å•ç®¡ç†" name="order">
					<view class="pane-content">
						<text class="content-title">è®¢å•ç®¡ç†</text>
						<text class="content-text">æŸ¥çœ‹å’Œç®¡ç†æ‰€æœ‰è®¢å•ä¿¡æ¯ï¼ŒåŒ…æ‹¬è®¢å•çŠ¶æ€ã€é…é€ç­‰ã€‚</text>
					</view>
				</zx-tab-pane>
				<zx-tab-pane label="å•†å“ç®¡ç†" name="goods">
					<view class="pane-content">
						<text class="content-title">å•†å“ç®¡ç†</text>
						<text class="content-text">ç®¡ç†å•†å“ä¿¡æ¯ï¼ŒåŒ…æ‹¬å•†å“æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤ç­‰æ“ä½œã€‚</text>
					</view>
				</zx-tab-pane>
				<zx-tab-pane label="åº“å­˜ç®¡ç†" name="stock">
					<view class="pane-content">
						<text class="content-title">åº“å­˜ç®¡ç†</text>
						<text class="content-text">å®æ—¶æŸ¥çœ‹åº“å­˜çŠ¶æ€ï¼Œè¿›è¡Œåº“å­˜è°ƒæ•´å’Œé¢„è­¦è®¾ç½®ã€‚</text>
					</view>
				</zx-tab-pane>
			</zx-tabs>
		</view>

		<view class="demo-section">
			<view class="demo-title">æ ‡ç­¾ä½ç½®è®¾ç½®</view>
			<view class="demo-desc">å¯ä»¥é€šè¿‡ tab-position è®¾ç½®æ ‡ç­¾çš„ä½ç½®ã€‚</view>
			<view class="position-controls">
				<button 
					v-for="pos in positions" 
					:key="pos" 
					@click="tabPosition = pos"
					:class="{ active: tabPosition === pos }"
					class="position-btn"
				>
					{{ pos }}
				</button>
			</view>
			<view class="tabs-container" :class="'position-' + tabPosition">
				<zx-tabs v-model="activeTab4" :tab-position="tabPosition">
					<zx-tab-pane label="æ ‡ç­¾ä¸€" name="tab1">
						<view class="pane-content">
							<text class="content-title">æ ‡ç­¾ä¸€</text>
							<text class="content-text">è¿™æ˜¯æ ‡ç­¾ä¸€çš„å†…å®¹ï¼Œå½“å‰ä½ç½®ï¼š{{ tabPosition }}</text>
						</view>
					</zx-tab-pane>
					<zx-tab-pane label="æ ‡ç­¾äºŒ" name="tab2">
						<view class="pane-content">
							<text class="content-title">æ ‡ç­¾äºŒ</text>
							<text class="content-text">è¿™æ˜¯æ ‡ç­¾äºŒçš„å†…å®¹ï¼Œå½“å‰ä½ç½®ï¼š{{ tabPosition }}</text>
						</view>
					</zx-tab-pane>
					<zx-tab-pane label="æ ‡ç­¾ä¸‰" name="tab3">
						<view class="pane-content">
							<text class="content-title">æ ‡ç­¾ä¸‰</text>
							<text class="content-text">è¿™æ˜¯æ ‡ç­¾ä¸‰çš„å†…å®¹ï¼Œå½“å‰ä½ç½®ï¼š{{ tabPosition }}</text>
						</view>
					</zx-tab-pane>
				</zx-tabs>
			</view>
		</view>

		<view class="demo-section">
			<view class="demo-title">åŠ¨æ€å¢å‡æ ‡ç­¾é¡µ</view>
			<view class="demo-desc">å¢å‡æ ‡ç­¾é¡µæŒ‰é’®åªèƒ½åœ¨é€‰é¡¹å¡æ ·å¼çš„æ ‡ç­¾é¡µä¸‹ä½¿ç”¨ã€‚</view>
			<zx-tabs 
				v-model="activeTab5" 
				type="card" 
				editable
				@tab-remove="handleTabRemove"
				@tab-add="handleTabAdd"
			>
				<zx-tab-pane 
					v-for="tab in editableTabs" 
					:key="tab.name"
					:label="tab.title" 
					:name="tab.name"
					:closable="tab.closable"
				>
					<view class="pane-content">
						<text class="content-title">{{ tab.title }}</text>
						<text class="content-text">{{ tab.content }}</text>
					</view>
				</zx-tab-pane>
			</zx-tabs>
		</view>

		<view class="demo-section">
			<view class="demo-title">è‡ªå®šä¹‰æ ‡ç­¾å†…å®¹</view>
			<view class="demo-desc">å¯ä»¥é€šè¿‡å…·åæ’æ§½æ¥å®ç°è‡ªå®šä¹‰æ ‡ç­¾é¡µçš„å†…å®¹ã€‚</view>
			<zx-tabs v-model="activeTab6" type="border-card">
				<template #tab-calendar>
					<view class="custom-tab">
						<text class="tab-icon">ğŸ“…</text>
						<text>æ—¥å†</text>
					</view>
				</template>
				<template #tab-setting>
					<view class="custom-tab">
						<text class="tab-icon">âš™ï¸</text>
						<text>è®¾ç½®</text>
					</view>
				</template>
				
				<zx-tab-pane label="æ—¥å†" name="calendar">
					<view class="pane-content">
						<text class="content-title">ğŸ“… æ—¥å†ç®¡ç†</text>
						<text class="content-text">è¿™æ˜¯ä¸€ä¸ªå¸¦æœ‰è‡ªå®šä¹‰å›¾æ ‡çš„æ—¥å†æ ‡ç­¾é¡µã€‚</text>
					</view>
				</zx-tab-pane>
				<zx-tab-pane label="è®¾ç½®" name="setting">
					<view class="pane-content">
						<text class="content-title">âš™ï¸ ç³»ç»Ÿè®¾ç½®</text>
						<text class="content-text">è¿™æ˜¯ä¸€ä¸ªå¸¦æœ‰è‡ªå®šä¹‰å›¾æ ‡çš„è®¾ç½®æ ‡ç­¾é¡µã€‚</text>
					</view>
				</zx-tab-pane>
				<zx-tab-pane label="å¸®åŠ©" name="help">
					<view class="pane-content">
						<text class="content-title">å¸®åŠ©æ–‡æ¡£</text>
						<text class="content-text">è¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„å¸®åŠ©æ ‡ç­¾é¡µã€‚</text>
					</view>
				</zx-tab-pane>
			</zx-tabs>
		</view>

		<view class="demo-section">
			<view class="demo-title">æ•°æ®é©±åŠ¨æ¨¡å¼</view>
			<view class="demo-desc">é€šè¿‡ tabs å±æ€§ä¼ å…¥æ ‡ç­¾æ•°æ®ï¼Œé€‚åˆåŠ¨æ€ç”Ÿæˆæ ‡ç­¾é¡µçš„åœºæ™¯ã€‚</view>
			<zx-tabs v-model="activeTab7" :tabs="tabsData" @tab-click="handleTabClick">
				<view class="pane-content">
					<text class="content-title">å½“å‰é€‰ä¸­ï¼š{{ activeTab7 }}</text>
					<text class="content-text">
						åœ¨æ•°æ®é©±åŠ¨æ¨¡å¼ä¸‹ï¼Œæ ‡ç­¾é¡µçš„å†…å®¹å¯ä»¥æ ¹æ®å½“å‰é€‰ä¸­çš„æ ‡ç­¾åŠ¨æ€æ˜¾ç¤ºã€‚
						å½“å‰é€‰ä¸­çš„æ ‡ç­¾ä¿¡æ¯ï¼š{{ getCurrentTabInfo(activeTab7) }}
					</text>
				</view>
			</zx-tabs>
		</view>

		<view class="demo-section">
			<view class="demo-title">å»¶è¿Ÿæ¸²æŸ“</view>
			<view class="demo-desc">æ ‡ç­¾é¡µå†…å®¹å¯ä»¥è®¾ç½®ä¸ºå»¶è¿Ÿæ¸²æŸ“ï¼Œæå‡æ€§èƒ½ã€‚</view>
			<zx-tabs v-model="activeTab8">
				<zx-tab-pane label="å³æ—¶æ¸²æŸ“" name="instant">
					<view class="pane-content">
						<text class="content-title">å³æ—¶æ¸²æŸ“</text>
						<text class="content-text">è¿™ä¸ªæ ‡ç­¾é¡µä¼šç«‹å³æ¸²æŸ“ï¼Œæ¸²æŸ“æ—¶é—´ï¼š{{ renderTime.instant }}</text>
					</view>
				</zx-tab-pane>
				<zx-tab-pane label="å»¶è¿Ÿæ¸²æŸ“" name="lazy" lazy>
					<view class="pane-content">
						<text class="content-title">å»¶è¿Ÿæ¸²æŸ“</text>
						<text class="content-text">è¿™ä¸ªæ ‡ç­¾é¡µåªæœ‰åœ¨æ¿€æ´»æ—¶æ‰ä¼šæ¸²æŸ“ï¼Œæ¸²æŸ“æ—¶é—´ï¼š{{ renderTime.lazy }}</text>
					</view>
				</zx-tab-pane>
			</zx-tabs>
		</view>

		<view class="demo-section">
			<view class="demo-title">å°ºå¯¸è®¾ç½®</view>
			<view class="demo-desc">æ”¯æŒä¸‰ç§å°ºå¯¸ï¼šlargeã€defaultã€smallã€‚</view>
			
			<view class="size-demo">
				<text class="size-label">å¤§å°ºå¯¸ (large)</text>
				<zx-tabs v-model="activeTab9" size="large" type="card">
					<zx-tab-pane label="æ ‡ç­¾ä¸€" name="tab1">
						<view class="pane-content size-content">å¤§å°ºå¯¸æ ‡ç­¾é¡µå†…å®¹</view>
					</zx-tab-pane>
					<zx-tab-pane label="æ ‡ç­¾äºŒ" name="tab2">
						<view class="pane-content size-content">å¤§å°ºå¯¸æ ‡ç­¾é¡µå†…å®¹</view>
					</zx-tab-pane>
				</zx-tabs>
			</view>

			<view class="size-demo">
				<text class="size-label">é»˜è®¤å°ºå¯¸ (default)</text>
				<zx-tabs v-model="activeTab10" size="default" type="card">
					<zx-tab-pane label="æ ‡ç­¾ä¸€" name="tab1">
						<view class="pane-content size-content">é»˜è®¤å°ºå¯¸æ ‡ç­¾é¡µå†…å®¹</view>
					</zx-tab-pane>
					<zx-tab-pane label="æ ‡ç­¾äºŒ" name="tab2">
						<view class="pane-content size-content">é»˜è®¤å°ºå¯¸æ ‡ç­¾é¡µå†…å®¹</view>
					</zx-tab-pane>
				</zx-tabs>
			</view>

			<view class="size-demo">
				<text class="size-label">å°å°ºå¯¸ (small)</text>
				<zx-tabs v-model="activeTab11" size="small" type="card">
					<zx-tab-pane label="æ ‡ç­¾ä¸€" name="tab1">
						<view class="pane-content size-content">å°å°ºå¯¸æ ‡ç­¾é¡µå†…å®¹</view>
					</zx-tab-pane>
					<zx-tab-pane label="æ ‡ç­¾äºŒ" name="tab2">
						<view class="pane-content size-content">å°å°ºå¯¸æ ‡ç­¾é¡µå†…å®¹</view>
					</zx-tab-pane>
				</zx-tabs>
			</view>
		</view>
	</view>
</template>

<script setup>
import { ref, reactive, onMounted, watch } from 'vue';

// åŸºç¡€ç”¨æ³•
const activeTab1 = ref('user');

// å¡ç‰‡é£æ ¼
const activeTab2 = ref('home');

// è¾¹æ¡†å¡ç‰‡
const activeTab3 = ref('order');

// ä½ç½®è®¾ç½®
const activeTab4 = ref('tab1');
const tabPosition = ref('top');
const positions = ['top', 'right', 'bottom', 'left'];

// åŠ¨æ€å¢å‡
const activeTab5 = ref('2');
let tabIndex = 2;
const editableTabs = reactive([
	{
		title: 'æ ‡ç­¾é¡µ 1',
		name: '1',
		content: 'æ ‡ç­¾é¡µ 1 çš„å†…å®¹ï¼Œå¯ä»¥å…³é—­æ­¤æ ‡ç­¾é¡µã€‚',
		closable: true
	},
	{
		title: 'æ ‡ç­¾é¡µ 2',
		name: '2',
		content: 'æ ‡ç­¾é¡µ 2 çš„å†…å®¹ï¼Œå¯ä»¥å…³é—­æ­¤æ ‡ç­¾é¡µã€‚',
		closable: true
	}
]);

// è‡ªå®šä¹‰æ ‡ç­¾å†…å®¹
const activeTab6 = ref('calendar');

// æ•°æ®é©±åŠ¨
const activeTab7 = ref('option1');
const tabsData = reactive([
	{ name: 'option1', label: 'é€‰é¡¹ä¸€', disabled: false, desc: 'ç¬¬ä¸€ä¸ªé€‰é¡¹' },
	{ name: 'option2', label: 'é€‰é¡¹äºŒ', disabled: false, desc: 'ç¬¬äºŒä¸ªé€‰é¡¹' },
	{ name: 'option3', label: 'é€‰é¡¹ä¸‰', disabled: true, desc: 'ç¬¬ä¸‰ä¸ªé€‰é¡¹ï¼ˆå·²ç¦ç”¨ï¼‰' },
	{ name: 'option4', label: 'é€‰é¡¹å››', disabled: false, desc: 'ç¬¬å››ä¸ªé€‰é¡¹' }
]);

// å»¶è¿Ÿæ¸²æŸ“
const activeTab8 = ref('instant');
const renderTime = reactive({
	instant: '',
	lazy: ''
});

// å°ºå¯¸è®¾ç½®
const activeTab9 = ref('tab1');
const activeTab10 = ref('tab1');
const activeTab11 = ref('tab1');

// ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
	renderTime.instant = new Date().toLocaleTimeString();
});

// ç›‘å¬å»¶è¿Ÿæ¸²æŸ“æ ‡ç­¾é¡µçš„æ¿€æ´»
watch(activeTab8, (newValue) => {
	if (newValue === 'lazy' && !renderTime.lazy) {
		renderTime.lazy = new Date().toLocaleTimeString();
	}
});

// äº‹ä»¶å¤„ç†
const handleTabClick = (data) => {
	console.log('æ ‡ç­¾é¡µç‚¹å‡»:', data);
	uni.showToast({
		title: `åˆ‡æ¢åˆ°: ${data.tab.label || data.tab.name}`,
		icon: 'none',
		duration: 1500
	});
};

const handleTabRemove = (targetName) => {
	const tabs = editableTabs;
	let activeName = activeTab5.value;
	
	if (activeName === targetName) {
		tabs.forEach((tab, index) => {
			if (tab.name === targetName) {
				const nextTab = tabs[index + 1] || tabs[index - 1];
				if (nextTab) {
					activeName = nextTab.name;
				}
			}
		});
	}
	
	activeTab5.value = activeName;
	const index = editableTabs.findIndex(tab => tab.name === targetName);
	if (index > -1) {
		editableTabs.splice(index, 1);
	}
	
	uni.showToast({
		title: 'æ ‡ç­¾é¡µå·²åˆ é™¤',
		icon: 'success',
		duration: 1500
	});
};

const handleTabAdd = () => {
	const newTabName = `${++tabIndex}`;
	editableTabs.push({
		title: `æ–°æ ‡ç­¾é¡µ ${tabIndex}`,
		name: newTabName,
		content: `è¿™æ˜¯æ–°æ·»åŠ çš„æ ‡ç­¾é¡µ ${tabIndex} çš„å†…å®¹ã€‚`,
		closable: true
	});
	activeTab5.value = newTabName;
	
	uni.showToast({
		title: 'æ ‡ç­¾é¡µå·²æ·»åŠ ',
		icon: 'success',
		duration: 1500
	});
};

const getCurrentTabInfo = (tabName) => {
	const tab = tabsData.find(t => t.name === tabName);
	return tab ? tab.desc : '';
};
</script>

<style scoped>
.demo-container {
	padding: 40rpx 30rpx;
	background-color: #f5f7fa;
	min-height: 100vh;
}

.page-header {
	text-align: center;
	margin-bottom: 60rpx;
	padding: 40rpx 20rpx;
	background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
	border-radius: 20rpx;
	color: #fff;
}

.page-title {
	display: block;
	font-size: 48rpx;
	font-weight: bold;
	margin-bottom: 20rpx;
}

.page-desc {
	display: block;
	font-size: 28rpx;
	opacity: 0.9;
}

.demo-section {
	margin-bottom: 60rpx;
	background-color: #fff;
	border-radius: 16rpx;
	padding: 40rpx 30rpx;
	box-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);
	border: 1rpx solid #f0f0f0;
}

.demo-title {
	font-size: 36rpx;
	font-weight: bold;
	color: #303133;
	margin-bottom: 16rpx;
}

.demo-desc {
	font-size: 28rpx;
	color: #606266;
	margin-bottom: 30rpx;
	line-height: 1.5;
}

.pane-content {
	padding: 30rpx;
	background-color: #fafbfc;
	border-radius: 12rpx;
	margin: 20rpx 0;
}

.content-title {
	display: block;
	font-size: 32rpx;
	font-weight: bold;
	color: #303133;
	margin-bottom: 16rpx;
}

.content-text {
	display: block;
	font-size: 28rpx;
	color: #606266;
	line-height: 1.6;
}

.position-controls {
	display: flex;
	gap: 20rpx;
	margin-bottom: 30rpx;
	flex-wrap: wrap;
}

.position-btn {
	padding: 16rpx 32rpx;
	border: 2rpx solid #dcdfe6;
	border-radius: 8rpx;
	background-color: #fff;
	color: #606266;
	font-size: 28rpx;
	transition: all 0.3s ease;
	cursor: pointer;
}

.position-btn.active {
	border-color: #409eff;
	color: #409eff;
	background-color: #ecf5ff;
}

.position-btn:hover {
	border-color: #c6e2ff;
	background-color: #ecf5ff;
}

.tabs-container {
	border: 1rpx solid #e4e7ed;
	border-radius: 8rpx;
	overflow: hidden;
}

.tabs-container.position-left,
.tabs-container.position-right {
	height: 400rpx;
}

.custom-tab {
	display: flex;
	align-items: center;
	gap: 8rpx;
}

.tab-icon {
	font-size: 32rpx;
}

.size-demo {
	margin-bottom: 40rpx;
}

.size-label {
	display: block;
	font-size: 30rpx;
	font-weight: bold;
	color: #409eff;
	margin-bottom: 20rpx;
}

.size-content {
	padding: 20rpx;
	text-align: center;
	font-size: 26rpx;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 750rpx) {
	.demo-container {
		padding: 30rpx 20rpx;
	}
	
	.demo-section {
		padding: 30rpx 20rpx;
	}
	
	.position-controls {
		justify-content: center;
	}
	
	.position-btn {
		flex: 1;
		min-width: 120rpx;
		text-align: center;
	}
}
</style>
